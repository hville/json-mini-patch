(function(f){function n(b,a){for(var c=0;c<a.length;++c){if(!b)return;b=b[a[c]]}return b}function h(b,a){var c=r(b);if(c===r(a))switch(c){case Array:if(b.length!==a.length)break;for(c=0;c<b.length;++c)if(!h(b[c],a[c]))return;return!0;case Object:var d=Object.keys(b);if(d.length!==Object.keys(a).length)break;for(c=0;c<d.length;++c)if(!h(b[d[c]],a[d[c]]))return;return!0;default:return b===a}}function r(b){return void 0===b?void 0:null===b?null:b.constructor||Object}function g(b,a){return"Patch item failed at "+
b+":"+JSON.stringify(a)}function k(b){return Array.isArray(b)?b.slice():Object.assign({},b)}function p(b,a){for(var c=a.length-1,d=0;d<c;++d){if(!b[a[d]])throw Error(g("path",a.toString()));b=b[a[d]]=k(b[a[d]])}return b}function q(b,a,c){if(void 0===c)throw Error(g("value",c));if(!a.length)return c;var d=k(b),e=p(d,a);a=a[a.length-1];if(Array.isArray(e)){if("-"===a||a===""+e.length)e.push(c);else{if(void 0===e[a])throw Error(g("path key",a));e.splice(a,0,c)}return d}if(h(e[a],c))return b;e[a]=c;return d}
function t(b,a){if(a.length){b=k(b);var c=p(b,a);a=a[a.length-1];if(void 0===c[a])throw Error(g("path key",a));Array.isArray(c)?c.splice(a,1):delete c[a];return b}}function u(b,a){for(var c=b,d=0;d<a.length;++d){var e=a[d],f=e[1],h=w[e[0]];if(!f)throw Error(g("path",f));if(!h)throw Error(g("op",e[0]));c=h(c,f,e[2]);if(void 0===c)return b}return c}function l(b){for(var a=-1,c=[],d=0;d<b.length;++d)"/"===b[d]?c[++a]="":c[a]="~"===b[d]?c[a]+("0"===b[++d]?"~":"1"===b[d]?"/":""):c[a]+b[d];return c}function v(b){for(var a=
0,c=[];a<b.length;++a)if(c[a]=x(b[a]),!c[a])return;return c}function x(b){var a=l(b.path);if(!b.value||!b.from)switch(b.a){case "add":return["a",a,b.value];case "replace":return["r",a,b.value];case "remove":return["d",a];case "test":return["t",a,b.value];case "move":return["m",a,l(b.from)];case "copy":return["c",a,l(b.from)]}}function m(b){for(var a=0,c="";a<b.length;++a){for(var d=b[a],e=0,f="";e<d.length;++e)f+="~"===d[e]?"~0":"/"===d[e]?"~1":d[e];c+="/"+f}return c}function y(b){var a=m(b[1]);switch(b[0]){case "a":return{a:"add",
path:a,value:b[2]};case "r":return{a:"replace",path:a,value:b[2]};case "d":return{a:"remove",path:a};case "t":return{a:"test",path:a,value:b[2]};case "m":return{a:"move",path:a,from:m(b[2])};case "c":return{a:"copy",path:a,from:m(b[2])}}}var w={t:function(b,a,c){a=n(b,a);if(void 0!==a&&h(a,c))return b},b:q,r:function(b,a,c){if(void 0===c)throw Error(g("value",c));if(!a.length)return c;var d=k(b),e=p(d,a);a=a[a.length-1];if(h(e[a],c))return b;if(void 0===e[a])throw Error(g("path key",a));e[a]=c;return d},
d:t,j:function(b,a,c){var d=n(b,c);if(void 0===d)throw Error(g("from",c));return q(t(b,c),a,d)},c:function(b,a,c){var d=n(b,c);if(void 0===d)throw Error(g("from",c));return q(b,a,d)}};f.i=function(b,a){return u(b,v(a))};f.l=u;f.f=v;f.restore=function(b){return b.map(y)};f.h=m;f.g=l;f.isEqual=h})(this["json-mini-patch"]=this["json-mini-patch"]||{});
